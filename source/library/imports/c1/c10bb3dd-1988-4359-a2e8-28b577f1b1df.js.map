{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Player.js"],"names":["cc","_decorator","ccclass","property","NewScript","AudioClip","enabled","accLeft","accRight","xSpeed","minPosX","node","parent","width","maxPosX","setInputControl","self","eventManager","addListener","event","EventListener","KEYBOARD","onKeyPressed","keyCode","eps","KEY","a","left","d","right","onKeyReleased","TOUCH_ONE_BY_ONE","onTouchBegan","touch","touchLoc","getLocation","x","winSize","onTouchEnded","jumpUp","moveBy","jumpDuration","p","jumpHeight","easing","easeCubicActionOut","jumpDown","easeCubicActionIn","squash","scaleTo","squashDuration","stretch","scaleBack","callback","callFunc","playJumpSound","repeatForever","sequence","audioEngine","playEffect","jumpAudio","centerPos","y","height","pos","setPosition","stopAllActions","dt","newV","accel","Math","abs","maxMoveSpeed","Component"],"mappings":"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","file":"Player.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["const {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewScript extends cc.Component {\r\n\r\n    \r\n    @property\r\n    jumpHeight = 0;\r\n   \r\n    @property\r\n    jumpDuration = 0;\r\n    \r\n    @property\r\n    squashDuration = 0;\r\n    \r\n    @property\r\n    maxMoveSpeed = 0;\r\n    \r\n    @property\r\n    accel = 0;\r\n\r\n    @property\r\n    eps = 0;\r\n\r\n    @property(cc.AudioClip)\r\n    jumpAudio = '';\r\n\r\n\r\n    onLoad () {\r\n        this.enabled = false;\r\n        this.accLeft = false;\r\n        this.accRight = false;\r\n        \r\n        this.xSpeed = 50;\r\n        // screen boundaries\r\n        this.minPosX = -this.node.parent.width/2;\r\n        this.maxPosX = this.node.parent.width/2;\r\n        \r\n        // this.jumpAction = this.setJumpAction();\r\n\r\n        this.setInputControl();\r\n    }\r\n\r\n    setInputControl () {\r\n        var self = this;\r\n        //add keyboard input listener to jump, turnLeft and turnRight\r\n        cc.eventManager.addListener({\r\n            event: cc.EventListener.KEYBOARD,\r\n            // set a flag when key pressed\r\n            onKeyPressed: function(keyCode, event) {\r\n                this.eps += 0.1;\r\n                switch(keyCode) {\r\n                    case cc.KEY.a:\r\n                    case cc.KEY.left:\r\n                        self.accLeft = true;\r\n                        self.accRight = false;\r\n                        break;\r\n                    case cc.KEY.d:\r\n                    case cc.KEY.right:\r\n                        self.accLeft = false;\r\n                        self.accRight = true;\r\n                        break;\r\n                }\r\n            },\r\n            // unset a flag when key released\r\n            onKeyReleased: function(keyCode, event) {\r\n                this.eps = 0;\r\n                switch(keyCode) {\r\n                    case cc.KEY.a:\r\n                    case cc.KEY.left:\r\n                        self.accLeft = false;\r\n                        break;\r\n                    case cc.KEY.d:\r\n                    case cc.KEY.right:\r\n                        self.accRight = false;\r\n                        break;\r\n                }\r\n            }\r\n        }, self.node);\r\n\r\n        // touch input\r\n        cc.eventManager.addListener({\r\n            event: cc.EventListener.TOUCH_ONE_BY_ONE,\r\n            onTouchBegan: function(touch, event) {\r\n                var touchLoc = touch.getLocation();\r\n                if (touchLoc.x >= cc.winSize.width/2) {\r\n                    self.accLeft = false;\r\n                    self.accRight = true;\r\n                } else {\r\n                    self.accLeft = true;\r\n                    self.accRight = false;\r\n                }\r\n                // don't capture the event\r\n                return true;\r\n            },\r\n            onTouchEnded: function(touch, event) {\r\n                self.accLeft = false;\r\n                self.accRight = false;\r\n            }\r\n        }, self.node);\r\n    }\r\n\r\n    setJumpAction () {\r\n        var jumpUp = cc.moveBy(this.jumpDuration, cc.p(0, this.jumpHeight)).easing(cc.easeCubicActionOut());\r\n        var jumpDown = cc.moveBy(this.jumpDuration, cc.p(0, -this.jumpHeight)).easing(cc.easeCubicActionIn());\r\n        var squash = cc.scaleTo(this.squashDuration, 1, 0.6);\r\n        var stretch = cc.scaleTo(this.squashDuration, 1, 1.2);\r\n        var scaleBack = cc.scaleTo(this.squashDuration, 1, 1);\r\n        var callback = cc.callFunc(this.playJumpSound, this);\r\n        return cc.repeatForever(cc.sequence(squash, stretch, jumpUp, scaleBack, jumpDown, callback));\r\n    }\r\n\r\n    \r\n    playJumpSound () {\r\n        cc.audioEngine.playEffect(this.jumpAudio, false);\r\n    }\r\n\r\n    getCenterPos () {\r\n        var centerPos = cc.p(this.node.x, this.node.y + this.node.height/2);\r\n        return centerPos;\r\n    }\r\n\r\n    startMoveAt (pos) {\r\n        this.enabled = true;\r\n        this.xSpeed = 0;\r\n        this.node.setPosition(pos);\r\n        // this.node.runAction(this.setJumpAction());\r\n    }\r\n\r\n    stopMove () {\r\n        this.node.stopAllActions();\r\n    }\r\n\r\n    // called every frame\r\n    update (dt) {\r\n        \r\n        var newV = this.accel * dt + this.eps;\r\n        if (this.accLeft) {\r\n            this.xSpeed -= newV;\r\n        } else if (this.accRight) {\r\n            this.xSpeed += newV;\r\n        }\r\n        if ( Math.abs(this.xSpeed) > this.maxMoveSpeed ) {\r\n            // if speed reach limit, use max speed with current direction\r\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\r\n        }\r\n\r\n        this.node.x += this.xSpeed * dt;\r\n\r\n        // limit player position inside screen\r\n        if ( this.node.x > this.node.parent.width/2) {\r\n            this.node.x = this.node.parent.width/2;\r\n            this.xSpeed = 0;\r\n        } else if (this.node.x < -this.node.parent.width/2) {\r\n            this.node.x = -this.node.parent.width/2;\r\n            this.xSpeed = 0;\r\n        }\r\n    }\r\n}\r\n"]}